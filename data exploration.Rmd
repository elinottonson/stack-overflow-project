---
title: "Stack Overflow Survey Analysis"
author: "Eli Nottonson and Kenneth Heisler"
output: html_notebook
editor_options: 
  chunk_output_type: console
---
```{r}
library(ggplot2)
library(tibble)
```

```{r}
##import dataset
stack.df <- read.csv("survey_results_public.csv")
```


```{r}
##get rows that have a salary
stack.withsal.df <- stack.df[!is.na(stack.df$ConvertedCompYearly),]
stack.entry.df <- stack.withsal.df[which(stack.withsal.df$YearsCodePro<=1),]
```

```{r}
# set up cut-off values 
breaks <- c(5000,10000,15000,20000,25000,30000,35000,40000,45000,50000,75000, 100000, 200000)
# specify interval/bin labels
tags <- c("[0-5)","[5-10)", "[15-20)", "[20-25)", "[25-30)", "[30-35)","[35-40)", "[40-45)","[45-50)", "[50-75)", "[75-100)", "[100-200)")

group_tags <- cut(stack.entry.df$ConvertedCompYearly, 
                  breaks=breaks, 
                  include.lowest=TRUE, 
                  right=FALSE, 
                  labels=tags)
# inspect bins
summary(group_tags)

ggplot(data = as_tibble(group_tags), mapping = aes(x=value)) + 
  geom_bar(fill="bisque",color="white",alpha=0.7) + 
  stat_count(geom="text", aes(label=sprintf("%.4f",..count../length(group_tags))), vjust=-0.5) +
  labs(x='mean salary in thousands') +
  theme_minimal() 
```